<!DOCTYPE html>
<html lang="en">
<head>
<title>注册</title>
<!-- for-mobile-apps -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="" />
	<!--<link rel="stylesheet" type="text/css" href="../assets/css/city/index.css"/>-->
	<link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.min.css"/>
	<!--<link rel="stylesheet" type="text/css" href="../assets/css/city/city-picker.css"/>-->
	<link rel="stylesheet" type="text/css" href="../assets/css/Doctor_port_css/jquery-steps/jquery.steps.css"/>
	<link rel="stylesheet" type="text/css" href="../assets/css/Doctor_port_css/sign_css/signup.css"/>
	<link rel="stylesheet" type="text/css" href="../assets/css/file-uploader/bootstrap-fileupload.css"/>
</head>
<body class="bodybox">

<!-- header -->
 <!-- Start header 最顶部：登陆、注册、医生端 -->
  <div id="head"></div>
<!-- //header -->

<!-- banner -->
	<section class="inner-banner-top">
		<div class="container">
		</div>
	</section>
<!-- //banner -->
	
	<section>
		
	</section>
<!-- signup -->
	<div class="row">
		
		<div class="col-sm-12 col-md-8 col-md-push-2">
			<div class="white-box">
				<h2 class="header-title">医生注册</h2>
				
				<form id="example-form" >
					<div class="col col-md-12 col-xs-12">
						<h3>账户</h3>
						
						<section class="formbox">
							
							<div class="form-group clearfix">
									<label class="col-md-2" for="doc_phone">手机 *</label>
									<div class="col-md-10">
										<input onblur="checkTel()"  id="doc_phone" name="doc_phone" type="text" class="required form-control">
										<span id="teltip" class="text-danger"></span>
									</div>
							</div>
							
							<div class="form-group clearfix">
									<label class="col-md-2" for="email">验证码 *</label>
									<div class="col-md-10">
										<input  id="doc_yzm" name="yzm" type="text" class="required yzm">
										<div class="sendbox">
											<button id="btnSendCode2" type="button" class="btn" onclick="sendMessage1('#doc_phone','#btnSendCode2')">获取验证码</button>
										</div>
									</div>
							</div>
							
							<div class="form-group clearfix">
								<label for="doc_password" class="col-md-2">密码 *</label>
								<div class="col-md-10">
									<input  id="doc_password" name="doc_password" type="password" class="required form-control">
								</div>
							</div>
							
							<div class="form-group clearfix">
								<label for="confirm" class="col-md-2">确认密码 *</label>
								<div class="col-md-10">
									<input id="confirm" name="confirm" type="password" class="required form-control">
								</div>
							</div>
							
						
							<p>(*) 必填项</p>
							
						</section>
						
						<h3>详情</h3>
						<section class="formbox"> 
							<div class="form-group clearfix">
								
							<div class="form-group clearfix">
								<label for="userName" class="col-md-2">真实姓名 *</label>
								<div class="col-md-10">
									<input  id="doc_name" name="userName" type="text" class="required form-control">
								</div>
							</div>
								
								<div class="form-group clearfix">
									<label for="name" class="col-md-2">性别 *</label>
									<div class="col-md-10">
										<label class="radio-inline">
											<input  type="radio" name="doc_sex"  value="男" checked="checked"> 男
										</label>
										<label class="radio-inline">
											<input  type="radio" name="doc_sex"  value="女"> 女
										</label>
									</div>
								</div>
								
								<div class="form-group clearfix">
									<label for="doc_age" class="col-md-2">年龄 *</label>
									<div class="col-md-10">
										<input  id="doc_age" name="doc_age" type="number" min="1" max="100" class="required form-control">
									</div>
								</div>
								
								<div class="form-group clearfix">
									<label class="col-md-2" for="idcard">身份证号码 *</label>
									<div class="col-md-10">
										<input  id="doc_idcard" name="idcard" type="text" class="required form-control">
									</div>
								</div>
								
								<p>(*) 必填项</p>
						</section>
						
						<h3>认证</h3>
						<section class="formbox">
							
								<div class="form-group clearfix">
									<label for="doc_hospital" class="col-md-2">所属医院 *</label>
									<div class="col-md-10">
										<input  id="doc_hospital" name="doc_hospital" type="text" class="required form-control">
									</div>
								</div>
								
								<div class="form-group clearfix">
									<label for="doc_dept" class="col-md-2">科室 *</label>
									<div class="col-md-10">
										<input  id="doc_dept" name="doc_dept" type="text" class="required form-control">
									</div>
								</div>
								
								<div class="form-group clearfix">
									<label for="doc_rank" class="col-md-2">职称 *</label>
									<div class="col-md-10">
										<input  id="doc_rank" name="doc_rank" type="text" class="required form-control">
									</div>
								</div>
								
								<div class="form-group clearfix">
									<label for="doc_work_age" class="col-md-2">工龄 *</label>
									<div class="col-md-10">
										<input  id="doc_work_age" name="doc_work_age" type="number"  min="0" class="required form-control">
									</div>
								</div>
								
						</section>
						
						<h3>完成</h3>
						<section class="formbox agreebox">
							
							<label for="doc_img">请上传证件照 *</label>
							<div class="fileupload fileupload-new" data-provides="fileupload">
								
								<div class="fileupload-new thumbnail" style="">
									<img src="http://www.placehold.it/200x150/EFEFEF/AAAAAA&text=no+image" alt="" />
								</div>
								
								<div class="fileupload-preview fileupload-exists thumbnail" style=""></div>
								
								<div>
									<span class="btn btn-theme02 btn-file">
							   	<span class="fileupload-new"><i class="fa fa-paperclip"></i> 选择照片</span>
									<span class="fileupload-exists"><i class="fa fa-undo"></i> 更换</span>
									<input type="file" class="default" id="doc_img" />
									</span>
								</div>
							</div>
							
							<input id="acceptTerms" name="acceptTerms" type="checkbox" class="required"> 
								<label for="acceptTerms">
									我已阅读<a href="#" id="note" class="agreement" data-toggle="modal" data-target="#komidori">《小翠医生协议》</a>
								</label>
						</section>
						
					</div>
						
						<!--<button type="submit" onclick="submitForm()">提交</button>-->
				</form>
				
			</div>
		</div>
	</div>
<!-- //signup -->

<!-- banner -->
<section class="inner-banner">
	<div class="container">
	</div>
</section>
<!-- //banner -->


<!-- footer -->

    <div id="foot"></div>    
      
<!-- //footer -->
<div class="modal fade" id="komidori" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
             aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">小翠医生</h4>
                    </div>
                    <div class="modal-body">
                        <h4>小翠医生协议</h4>
                        <p>打不还口，骂不还手，宠溺上司</p>
                    </div>
                    <div class="modal-footer">
                        <button id="" type="button" class="btn btn-default" data-dismiss="modal">确认</button>
                        <!--<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>-->
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal -->
        </div>		
<!--================================================================-->

    <!-- js -->
    <!-- All JavaScript files
    ================================================== -->
    
   <!--jquery-->
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
    
    <!--bootstrap-->
		<script src="https://cdn.bootcss.com/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>
    
     <!--Begin core plugin -->
    <!--<script src="../../assets/js/jquery.min.js"></script>
    <script src="../../assets/js/bootstrap.min.js"></script>-->
    
    <!-- Plugins for this template -->
    <script src="../assets/js/jquery-plugin-collection.js"></script>

    <!-- Custom script for this template -->
    <script src="../assets/js/script.js"></script>
    
    <!--滑动-->
		<script src="../assets/js/smoothscroll.js" ></script>
    
    <!--step-->
    <script src="../assets/js/jquery-validation/jquery.validate.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../assets/js/jquery-steps/jquery.steps.min.js" type="text/javascript" charset="utf-8"></script>
    
    <!--发送短信-->
   	<script src="../assets/js/sendmessage/sendmsg.js" type="text/javascript" charset="utf-8"></script>
    
    <!--fileupload-->
    <script src="../assets/js/file-uploader/bootstrap-fileupload.js" type="text/javascript" charset="utf-8"></script>	
    
    <!--<script src="../assets/js/vue/vue.min.js" type="text/javascript" charset="utf-8"></script>-->
    <script src="../assets/js/GlobalVariables.js" type="text/javascript" charset="utf-8"></script>
 		<!--<script src="../assets/js/GlobalMethod.js" type="text/javascript" charset="utf-8"></script>-->

    <!-- //js ===========================================-->
<script>

$("#head").load("doc_logobar.html");
$("#foot").load("low_footer.html");

function checkTel(){
	var tel = $("#doc_phone").val();
            	 $.ajax({
		            url: "http://" + host + "/DocPort/reg_checkTel",
		            method: "get",
		            data: {
		                tel: tel,
		            },
		            xhrFields: {
		                withCredentials: true  //带上cookie信息，解决sessionid不一致
		            },
		            success: function (result) {
		                if(result.data!=0){
		                	$("#teltip").text("*手机号已被注册");
		                }
		                else{
		                	$("#teltip").text("");
		                }
		            }
		        					});
            }



	$("#example-basic").steps({
  headerTag: "h3",
  bodyTag: "section",
  autoFocus: true
  });
//steps with form
  var form = $("#example-form");
  
  form.validate({
    errorPlacement: function errorPlacement(error, element) {
      element.before(error);
                																						},
      rules: {
        confirm: {
          equalTo: "#doc_password"
                 },
          userName:{
          	required:true,
        		checkname:true
          },
          doc_phone:{
          	required:true,
          	checktel:true
          },
          doc_password:{
          	required:true,
          	checkpwd:true,
        	minlength:8
          },
          doc_age:{
          	range:[0,100],
          	number:true
          },
          idcard:{
          	checkid:true
          },
          doc_work_age:{
          	number:true,
          	range:[0,60]
          },
          doc_img:{
          	required:true
          }
        
             },
      massage:{
      	doc_password:{
          	minlength:'密码长度必须大于8'
          },
        doc_age:{
          	range:'请填写正确的年龄！',
          	number:'年龄必须是数字'
         },
        doc_work_age:{
          	number:'工龄必须是数字',
          	range:'工龄必须在0-60范围以内'
          },
        doc_img: {
        	required:'请上传您的证件照!'
        }
       
       
      }
            		});
    //手机验证
      $.validator.addMethod("checktel",function(value,element,params){
				var checktel = /^1[3,5,7,8]\d{9}$/;
				return this.optional(element)||(checktel.test(value));
			},"请输入正确的手机号码！");
      //人名验证
      $.validator.addMethod("checkname",function(value,element,params){
				var checkname = /^[\u4E00-\u9FA5\uf900-\ufa2d]{2,4}$/;
//			var checkname = /^[\u4E00-\u9FA5\uf900-\ufa2d·s]{2,20}$/;
				return this.optional(element)||(checkname.test(value));
			},"请输入正确的真实姓名！"); 
			
			$.validator.addMethod("checkpwd",function(value,element,params){
				var checkpwd = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;
				return this.optional(element)||(checkpwd.test(value));
			},"密码必须包括英文大写、英文小写以及数字,长度大于8！");
			
			$.validator.addMethod("checkid",function(value,element,params){
				var checkid = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;
				return this.optional(element)||(checkid.test(value));
			},"*请输入正确的身份证号码！");
      
            		
  	form.children("div").steps({
    headerTag: "h3",
    bodyTag: "section",
    transitionEffect: "slideLeft",
    onStepChanging: function (event, currentIndex, newIndex)
      {
        form.validate().settings.ignore = ":disabled,:hidden";
        return form.valid();
      },
    onFinishing: function (event, currentIndex)
      {
        form.validate().settings.ignore = ":disabled";
        return form.valid();
      },
        onFinished: function (event, currentIndex)
      {
      	//alert("提交成功");
      	var teltip = $("#teltip").text();
      	if(teltip=="手机号已被注册"){
      		alert("手机号已被注册,请重试");
      		return false;
      	}
        $.ajax({
            url: "http://" + host + "/DocPort/docRegister",
						method:"post",
						data:{
								doctorName : $("#doc_name").val(),
			      		doctorPwd : $("#doc_password").val(),
			      		doctorAge : $("#doc_age").val(),
			      		doctorIdcard : $("#doc_idcard").val(),
			      		doctorTel : $("#doc_phone").val(),
			      		doctorSex : $('input[name="doc_sex"]').val(),
			      		doctorHospital : $("#doc_hospital").val(),
			      		doctorDept : $("#doc_dept").val(),
			      		doctorRank : $("#doc_rank").val(),
			      		docWorkAge : $("#doc_work_age").val(),
								yzm:$("#doc_yzm").val()
						},
//					dataType: "json",
//         	contentType: "application/json;charset-UTF-8",
						xhrFields:{
							withCredentials:true  //带上cookie信息，解决sessionid不一致
						},
			     	success: function (result) {
			     		
			        var message = result.message
							if(message != "success"){
								alert(message);
							} 
							else {
								alert("注册成功，请耐心等待管理员审核。")
								window.location.href = 'doc_signin.html'
							}
			            
			     	}
	        });//ajax end
      }
            				});//steps end
            							


</script>

</body>
</html>